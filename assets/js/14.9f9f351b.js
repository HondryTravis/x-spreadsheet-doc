(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{362:function(s,a,t){"use strict";t.r(a);var e=t(42),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"spreadsheet"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#spreadsheet"}},[s._v("#")]),s._v(" Spreadsheet")]),s._v(" "),t("p",[s._v("主要入口类，涉及表格初始化，data 初始化相关")]),s._v(" "),t("p",[s._v("调用方法为：")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// instance 你创建的实例，公有方法可以直接调用，私有方法不可以")]),s._v("\n  instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("publicFn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"主要实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#主要实例"}},[s._v("#")]),s._v(" 主要实例")]),s._v(" "),t("p",[s._v("统一暴露在 "),t("code",[s._v("window")]),s._v(" 下")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 你可以在 window 上访问")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("spreadsheet")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("el"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" options "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Spreadsheet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("el"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x_spreadsheet "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" spreadsheet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  window"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x_spreadsheet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("locale")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("lang"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" message")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("locale")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lang"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 你可以这样创建")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" xs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("x_spreadsheet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("也可以将库作为你开发的目录")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// index.js 这是默认导出的")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" Spreadsheet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  spreadsheet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// you local main page")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 你可以直接导入本地库引入")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Spreadsheet "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'[path]'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h2",{attrs:{id:"公有方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#公有方法"}},[s._v("#")]),s._v(" 公有方法")]),s._v(" "),t("h3",{attrs:{id:"addsheet-name-active"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#addsheet-name-active"}},[s._v("#")]),s._v(" addSheet(name, active)")]),s._v(" "),t("p",[t("strong",[s._v("功能")]),s._v(" 添加多表")]),s._v(" "),t("p",[t("code",[s._v("@param name")]),s._v(" string 名称")]),s._v(" "),t("p",[t("code",[s._v("@param active")]),s._v(" boolean 默认为 true")]),s._v(" "),t("h3",{attrs:{id:"cell-ri-ci-sheetindex"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cell-ri-ci-sheetindex"}},[s._v("#")]),s._v(" cell(ri, ci, sheetIndex)")]),s._v(" "),t("p",[t("strong",[s._v("功能")]),s._v(" 获得单元格内容")]),s._v(" "),t("p",[t("code",[s._v("@param ri")]),s._v(" number 行坐标")]),s._v(" "),t("p",[t("code",[s._v("@param ci")]),s._v(" number 列坐标")]),s._v(" "),t("p",[t("code",[s._v("@param sheetIndex")]),s._v(" number 默认值为：0，当前表格index")]),s._v(" "),t("h3",{attrs:{id:"cellstyle-ri-ci-sheetindex"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cellstyle-ri-ci-sheetindex"}},[s._v("#")]),s._v(" cellStyle(ri, ci, sheetIndex)")]),s._v(" "),t("p",[t("strong",[s._v("功能")]),s._v(" 获得单元格样式属性")]),s._v(" "),t("p",[t("code",[s._v("@param ri")]),s._v(" number 行坐标")]),s._v(" "),t("p",[t("code",[s._v("@param ci")]),s._v(" number 列坐标")]),s._v(" "),t("p",[t("code",[s._v("@param sheetIndex")]),s._v(" number 默认值为：0，当前表格index")]),s._v(" "),t("h3",{attrs:{id:"celltext-ri-ci-text-sheetindex"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#celltext-ri-ci-text-sheetindex"}},[s._v("#")]),s._v(" cellText(ri, ci, text, sheetIndex)")]),s._v(" "),t("p",[t("strong",[s._v("功能")]),s._v(" 设置选定表格中的单元格的值")]),s._v(" "),t("p",[t("code",[s._v("@param ri")]),s._v(" number 行坐标")]),s._v(" "),t("p",[t("code",[s._v("@param ci")]),s._v(" number 列坐标")]),s._v(" "),t("p",[t("code",[s._v("@param text")]),s._v(" string")]),s._v(" "),t("p",[t("code",[s._v("@param sheetIndex")]),s._v(" number 默认值为：0，当前表格index")]),s._v(" "),t("h3",{attrs:{id:"rerender"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rerender"}},[s._v("#")]),s._v(" reRender()")]),s._v(" "),t("p",[t("strong",[s._v("功能")]),s._v(" 重新刷新整个表格")]),s._v(" "),t("h3",{attrs:{id:"deletesheet"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deletesheet"}},[s._v("#")]),s._v(" deleteSheet()")]),s._v(" "),t("p",[t("strong",[s._v("功能")]),s._v(" 删除当前表")]),s._v(" "),t("h3",{attrs:{id:"loaddata-data-加载数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#loaddata-data-加载数据"}},[s._v("#")]),s._v(" loadData(data) 加载数据")]),s._v(" "),t("p",[t("code",[s._v("@param {data}")]),s._v(" json 数据格式")]),s._v(" "),t("p",[t("strong",[s._v("如何获取数据格式:")]),s._v(" 请使用 "),t("code",[s._v("getData()")]),s._v(" 方法")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Spreadsheet "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-data-spreadsheet"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" xs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Spreadsheet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#x-spreadsheet-demo"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// data 是 json 格式")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 加载数据")]),s._v("\n  xs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("loadData")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"getdata-获取数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#getdata-获取数据"}},[s._v("#")]),s._v(" getData() 获取数据")]),s._v(" "),t("p",[s._v("获取数据")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 获取数据 d")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" xs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getData")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"change-callback-变更事件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#change-callback-变更事件"}},[s._v("#")]),s._v(" change(callback) 变更事件")]),s._v(" "),t("p",[s._v("页面操作或者数据发生变化")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 如")]),s._v("\n  xs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("change")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("data")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 默认会返回整个数据 json")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"locale-lang-message-本地化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#locale-lang-message-本地化"}},[s._v("#")]),s._v(" locale(lang, message) 本地化")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 加载语言包, 需要cdn 引入汉化文件或者从本地导入")]),s._v("\n  xs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("locale")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'zh-cn'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"on-eventname-callback-绑定事件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#on-eventname-callback-绑定事件"}},[s._v("#")]),s._v(" on(eventName, callback) 绑定事件")]),s._v(" "),t("p",[s._v("监听事件")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("  xs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cell-selected'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("cell"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ri"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ci")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// to do ...")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);